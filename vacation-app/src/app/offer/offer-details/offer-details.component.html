<app-spinner *ngIf="isLoading"></app-spinner>
<div class="wrapper" *ngIf="!isLoading">
  <div class="carousel-container">
    <app-offer-images-carousel [offer]="offer"></app-offer-images-carousel>
  </div>
  <section class="offer-data">
    <div class="info-container">
      <div class="info-left">
        <div class="title">
          <h1>{{ offer.title }}</h1>
          <h4 class="location">
            <mat-icon>location_on</mat-icon
            ><span>{{ offer.town }}, {{ offer.country.name }}</span>
          </h4>
        </div>
        <div class="info">
          <div class="subtitle">
            <h3>Tranquil Mediterranean sanctuary.</h3>
            <div
              class="actions"
              *ngIf="(isLogged$ | async) && !currentUser?.isAgency"
            >
              <section
                #reviewContainer
                class="review-container"
                *ngIf="isOpenReviewContainer"
              >
                <app-review
                  (addedReview)="addedReviewHandler($event)"
                  (close)="closeReviewContainer()"
                  [offerId]="offerId"
                ></app-review>
              </section>
              <button
                class="rate"
                mat-icon-button
                title="Rate this offer"
                type="button"
                (click)="openReviewWindow()"
              >
                <mat-icon>rate_review</mat-icon>
              </button>
              <button
                class="favorites"
                title="Add to favorites"
                mat-icon-button
                type="button"
              >
                <mat-icon>favorite_border</mat-icon>
              </button>
            </div>
            <div
              class="actions"
              *ngIf="(isLogged$ | async) && currentUser?.isAgency"
            >
              <button class="rate" mat-icon-button title="Edit" type="button">
                <mat-icon>edit</mat-icon>
              </button>
              <button
                class="favorites"
                title="Delete"
                mat-icon-button
                type="button"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
          <div></div>
          <div class="description">
            <p>{{ offer.description }}</p>
          </div>
          <div class="booking">
            <h1>Price: {{ offer.price }}$</h1>
            <a
              class="book-btn"
              [routerLink]="['/offers/book/', offer._id]"
              *ngIf="(isLogged$ | async) && !currentUser?.isAgency"
            >
              <span>Book</span>
              <mat-icon>airplane_ticket</mat-icon>
            </a>
          </div>
        </div>
      </div>
      <div class="features">
        <div class="features-title">
          <h1>Features</h1>
        </div>
        <ul class="feature-list">
          <ng-container *ngIf="offer.features.length > 0">
            <li *ngFor="let feature of offer.features">{{ feature }}</li>
          </ng-container>
          <li *ngIf="offer.features.length == 0">No Features added...</li>
        </ul>
      </div>
    </div>
  </section>
  <app-offer-reviews [reviews]="offer.reviews"></app-offer-reviews>
  <section class="more-offers" *ngIf="!currentUser?.isAgency">
    <app-more-offers
      [moreOffersFromAgency]="moreOffersFromAgency()"
      [agencyName]="agencyName"
    ></app-more-offers>
  </section>
</div>
